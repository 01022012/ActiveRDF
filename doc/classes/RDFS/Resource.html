<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type"/><title>Class: RDFS::Resource</title><link rel="stylesheet" type="text/css" media="screen" href="../.././rdoc-style.css"/><script type="text/javascript">
// Javascript for Allison RDoc template
// Copyright 2006 Cloudburst LLC
// Some sections originally from public domain material

var href_base = '../.././rdoc-style.css'.replace(/(.*\/).*/, '$1'); // haha! inline js is good for something  

function $(id) {
    if (document.getElementById)
      elem = document.getElementById(id);
    else if ( document.all )
      elem = eval("document.all." + id);
    else
      return false;
    return elem;
}

  function toggle(id) {
    elem = $(id);
    elemStyle = elem.style;   
    if (elemStyle.display == "block") {
      elemStyle.display = "none"
    } else {
      elemStyle.display = "block"
    }
    return true;
  }

  function toggleText(id) {
    elem = $(id)
    if (m = elem.innerHTML.match(/(Hide)(.*)/)) {
      elem.innerHTML = "Show" + m[2];
    } else if (m = elem.innerHTML.match(/(Show)(.*)/)) {
      elem.innerHTML = "Hide" + m[2];
    }
    return true;
  }

function span(s, klass) {
  return '<span class="' + klass + '">' + s + '</span>';
}
  
function highlightSymbols() {
  pres = document.getElementsByTagName('pre');
  for(var i = 0; i < pres.length; i++) {
    pre = pres[i];
    spans = pre.getElementsByTagName('span');
    for(var k = 0; k < spans.length; k++) {
      span = spans[k];
      if (span.className.match(/ruby-identifier/)) {
        if (span.innerHTML.match(/^:/)) {
          span.className += " ruby-symbol";
        }
      }
    }
  }
}

 function hasClass(obj) {
     var result = false;
     if (obj.getAttributeNode("class") != null) {
         result = obj.getAttributeNode("class").value;
     }
     return result;
  }   

 function stripe() {
    var even = true;
    var color = "#f4eefd";
    var tables = document.getElementsByTagName('table');
    if (tables.length == 0) { return; }
    for (var h = 0; h < tables.length; h++) {
        var trs = tables[h].getElementsByTagName("tr");
        for (var i = 0; i < trs.length; i++) {
          var tds = trs[i].getElementsByTagName("td");
            for (var j = 0; j < tds.length; j++) {       
              if (hasClass(tds[j]) != "first") {                
              var mytd = tds[j];
              if (even) {
                mytd.style.backgroundColor = color;
              }         
            }
          }
          even =  ! even;
      }
    }
  }
  
function ajaxGet(url) {
  url = (href_base + url).replace('/./', '/')
  var req = false;

  if (window.ActiveXObject) {
    try {
      // stupid hack because IE7 disables local Ajax with the native xmlhttprequest object
      // for security purposes. Yet ActiveX still works. Thanks, Microsoft. I hate you. Die.
      req = new ActiveXObject("MSXML2.XMLHTTP.3.0");
    } catch (e) {
      try {
        /* IE 6 and maybe 5, don't know, don't care */
        req = new ActiveXObject("Msxml2.XMLHTTP");
      } catch (e) {
        try {
          req = new ActiveXObject("Microsoft.XMLHTTP");
        } catch (e) {
          req = false;
        }
      }
    }
  }
    
  /* real browsers */
  if (!req && window.XMLHttpRequest) {
    try {
      req = new XMLHttpRequest();
    } catch (e) {
      req = false;
    }
  } 
  
  if (req) {
    req.open('GET', url, false);
    req.send(null);
    return req.responseText;
  } else {
    return "Ajax error";  
  }
}


function addEvent(elm, evType, fn, useCapture) {
	if (elm.addEventListener) {
	  elm.addEventListener(evType, fn, useCapture);  
  	return true;
	} else if (elm.attachEvent) {
  	var r = elm.attachEvent('on' + evType, fn);  
	  return r;  
	} else {
  	elm['on' + evType] = fn;
	}
}

function insertIndices() {
  pages = ["class", "file", "method"]
  for (x in pages) { 
    $(pages[x]).innerHTML += ajaxGet('fr_' + pages[x] + '_index.html').replace(/(href=")/g, '$1' + href_base);
  }
  /* mouseoverify method links */
  links = $('method').getElementsByTagName('a');
  for (var x = 0; x < links.length; x++) {
    if (m = links[x].innerHTML.match(/(.*)\s\((.*)\)/)) {
      links[x].innerHTML = m[1] + '<br>';
      links[x].title = m[2];
    }
  }
  /* this is stupid */
  $('class').style.display = "block";
  $('file').style.display = "block";
  
  /* has to be here because IE7 does not guarantee the onLoad callback order */
  abbreviateIndicesInner(["class", "file"], 25, "a");
  /* same, linkTitle() depends on the class link list */
  linkTitle();
}

function abbreviateIndices() {
  abbreviateIndicesInner(["defined_in", "child_of", "includes"], 20, 'a');
  abbreviateIndicesInner(["defined_in", "requires", "child_of", "includes"], 20, 'span');
}

function abbreviateIndicesInner(indices, amount, tag) {
  for (var x = 0; x < indices.length; x++) { 
    var the_index = $(indices[x]);
    if (the_index) {
      links = the_index.getElementsByTagName(tag);
      for (var y = 0; y < links.length; y++) {
        var link = links[y];
        if (link.getElementsByTagName('span').length == 0 && link.getElementsByTagName('a').length == 0) {
          // avoid nesting
          link.innerHTML = abbreviate(link.innerHTML, amount);
        }
      }
    }
  }
}

function linkTitle() {
  /* grab the correct title element from the index */
  var index_page = ajaxGet('index.html');
  title_text = index_page.match(/<title>(.*)<\/title>/m)[1];
  document.title = title_text + " - " + document.title;
  var p = $('header').getElementsByTagName('p')[0]
  if (p.innerHTML.match(/^\s*$/)) {
    p.innerHTML = title_text;
  } else {
    p.innerHTML = title_text + ": " + p.innerHTML;
  }
  /* set the link properly */
  title_link = index_page.match(/<a\s+href="(.*?)"/)[1];
  var element = $('title');
  var item_type = "";
  var item_name = "";
  if (m = element.innerHTML.match(/(Class:|Module:|File:)\s*(.*)/)) {
    item_type = m[1];
    item_name = m[2];
  } else {
    item_name = element.innerHTML;
  }
  element.innerHTML = '<a href="' + href_base + title_link + '">' + item_type + " " + abbreviate(item_name, 25) + '</a>';
  /* breadcrumb navigation for the win */
  items = item_name.split("::");
  items_new = item_name.split("::");
  var s = ""
  file_links = $('class').getElementsByTagName('a');
  for (var x = 0; x < items.length - 1; x++ ){
    var item = items[x];
    link = ("/classes/" + items.slice(0,x).join("/") + "/" + item + ".html").replace('//', '/');
    regex = new RegExp(RegExp.escape(link) + '$');
    for (var y = 0; y < file_links.length; y++) {
      if (file_links[y].href.match(regex)) {
         items_new[x] = '<a href="' + href_base + link + '">' + item + '</a>';
         break;
      }
    }  
  }
  $('item_name').innerHTML = item_type + ' ' + items_new.join(" :: ");
}

function abbreviate(s, size) {
  while (s.length > size) {
    var old_s = s;
    s = s.replace(/\s|\n/mg, '');
    s = s.replace(/([A-Z])[a-z]+/m, '$1');
    if (!s || old_s == s) {
      return "..." + s.substring(s.length - size, s.length);
    }
  }
  return s;
}

function disableSubmit(event) {
  var keyCode = event.keyCode ? event.keyCode : event.which ? event.which : event.charCode;
  if (keyCode == 13) {
    return false;
  } else {
    return true;
  }
}
  
function filterList(id, s, event) {
  
  /* some half-assed escaping */
  s = s.replace(/[^\w\d\.\_\-\/\:\=\[\]\?\!]/g, '');
  s = RegExp.escape(s);
  
  var show_all = false;
  if (s.match(/^\s*$/)) {
    show_all = true;
  }
  
  links = $(id).getElementsByTagName('a')
  regex = new RegExp(s, 'i');
  
  for (var x = 0; x < links.length; x++) {
    var link = links[x];
    if (show_all) {
      link.style.display = 'inline';
    } else {
       if (link.innerHTML.match(regex)) {        
         link.style.display = 'inline';
       } else {
         link.style.display = 'none';
       }
    }
  }
  return true;
}

RegExp.escape = function(text) {
  if (!arguments.callee.sRE) {
    var specials = [
      '/', '.', '*', '+', '?', '|',
      '(', ')', '[', ']', '{', '}', '\\'
    ];
    arguments.callee.sRE = new RegExp(
      '(\\' + specials.join('|\\') + ')', 'g'
    );
  }
  return text.replace(arguments.callee.sRE, '\\$1');
}


function hacks() {
  // show the spacer if necessary, 
  divs = document.getElementsByTagName('div');
  for (x in divs) {
    if (divs[x].className && divs[x].className.match(/top/)) {
      document.getElementById('spacer').style.display = 'block';
    }
  }
}

addEvent(window, 'load', insertIndices, false);
addEvent(window, 'load', abbreviateIndices, false);
addEvent(window, 'load', stripe, false);
addEvent(window, 'load', highlightSymbols, false);
addEvent(window, 'load', hacks, false);
</script></head><body><div id="container"><div class="curve" id="preheader_curve_0"></div><div class="curve" id="preheader_curve_1"></div><div class="curve" id="preheader_curve_2"></div><div class="curve" id="preheader_curve_3"></div><div class="curve" id="preheader_curve_4"></div><div class="curve" id="preheader_curve_5"></div><div class="curve" id="preheader_curve_6"></div><div class="curve" id="preheader_curve_7"></div><div class="curve" id="preheader_curve_8"></div><div class="curve" id="preheader_curve_9"></div><div id="header"><p>
</p><span><h1 id="title">
Class: RDFS::Resource
</h1></span>
</div><div class="clear"></div><div id="left">
<div class="navigation dark top" id="child_of"><h3>Child of</h3><span>

Object
</span></div>

<div class="navigation dark top" id="defined_in"><h3>Defined in</h3>

<a href="../../files/lib/active_rdf/objectmanager/resource_rb.html">lib/active_rdf/objectmanager/resource.rb</a>

</div>



<div class="navigation top" id="methods"><h3>Methods</h3>

<span class='bpink'>

<a href='#M000113'>
&lt;=&gt;<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000111'>
==<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000110'>
==<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000120'>
[]<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000121'>
[]=<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000125'>
add_predicate<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000127'>
class_level_predicates<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000128'>
direct_predicates<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000118'>
find<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000117'>
find<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000116'>
find_all<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000112'>
hash<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000130'>
include?<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000126'>
instance_of?<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000119'>
localname<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000115'>
method_missing<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000122'>
method_missing<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000108'>
new<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000114'>
predicates<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000129'>
property_accessors<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000123'>
save<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000131'>
to_s<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000124'>
type<br/>
</a>
</span>


<span class='bpink'>

<a href='#M000109'>
uri<br/>
</a>
</span>

</div>
<div id="spacer"></div><div class="navigation dark index" id="class_wrapper"><div class="list_header"><h3>All classes</h3></div><div class="list_header_link"><a onclick="toggle('class'); toggleText('class_link'); return false;" href="#" id="class_link">Hide...</a></div><div class="clear"></div><div id="class"><form><label for="filter_class">Filter:&nbsp;&nbsp;</label><input onKeyUp="return filterList('class', this.value, event);" type="text" onKeyPress="return disableSubmit(event);" id="filter_class"></input></form></div></div><div class="navigation dark index" id="file_wrapper"><div class="list_header"><h3>All files</h3></div><div class="list_header_link"><a onclick="toggle('file'); toggleText('file_link'); return false;" href="#" id="file_link">Hide...</a></div><div class="clear"></div><div id="file"><form><label for="filter_file">Filter:&nbsp;&nbsp;</label><input onKeyUp="return filterList('file', this.value, event);" type="text" onKeyPress="return disableSubmit(event);" id="filter_file"></input></form></div></div><div class="navigation dark index" id="method_wrapper"><div class="list_header"><h3>All methods</h3></div><div class="list_header_link"><a onclick="toggle('method'); toggleText('method_link'); return false;" href="#" id="method_link">Show...</a></div><div class="clear"></div><div id="method"><form><label for="filter_method">Filter:&nbsp;&nbsp;</label><input onKeyUp="return filterList('method', this.value, event);" type="text" onKeyPress="return disableSubmit(event);" id="filter_method"></input></form></div></div><div class="curve" id="left_curve_0"></div><div class="curve" id="left_curve_1"></div><div class="curve" id="left_curve_2"></div><div class="curve" id="left_curve_3"></div><div class="curve" id="left_curve_4"></div><div class="curve" id="left_curve_5"></div><div class="curve" id="left_curve_6"></div><div class="curve" id="left_curve_7"></div><div class="curve" id="left_curve_8"></div><div class="curve" id="left_curve_9"></div></div><div id="content">
<h1 id="item_name">Class: RDFS::Resource</h1>

<h1>Description</h1><p>
Represents an RDF resource and manages manipulations of that resource,
including data lookup (e.g. eyal.age), data updates (e.g. eyal.age=20),
class-level lookup (Person.find_by_name &#8216;eyal&#8217;), and
class-membership (eyal.class &#8230;Person).
</p>





<p></p>



<h1>Aliases</h1><p><table><tr><th class="first"> </th><th>Old name</th><th>New name</th><th colspan="2" class="description">Description</th></tr>
<tr><td class="first"> </td>


<td class="highlight">'=='</td>

<td class="normal">'eql?'</td>

<td>
</td><td>
</td></tr>
</table></p>

<h1>Attributes</h1><p><table><tr><th class="first"> </th><th>Name</th><th>Read/write?</th><th colspan="2" class="description">Description</th></tr>
<tr><td class="first"> </td>
<td class="highlight">class_uri</td>




<td class="normal">RW</td>
<td>
</td><td>

</td></tr>
<tr><td class="first"> </td>
<td class="highlight">uri</td>




<td class="normal">R</td>
<td>
</td><td>

<a href="Resource.html#M000109">uri</a> of the resource (for instances of
this class: rdf resources)


</td></tr>
</table></p>


<div class="section_spacer"></div><h1>Public Class methods</h1>


<a class="small" name="M000110"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000110'>


==

(other)

</a>
</h3>

<p class="source_link" id="M000110-show-link"><a onclick="toggle('M000110-source'); toggleText('M000110-link'); return false;" href="#" id="M000110-link">Show source...</a></p><div class="source" id="M000110-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 44</span>
44:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
45:       <span class="ruby-identifier">other</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:uri</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">uri</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>
46:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000117"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000117'>


find

(*args)

</a>
</h3>

<p class="source_link" id="M000117-show-link"><a onclick="toggle('M000117-source'); toggleText('M000117-link'); return false;" href="#" id="M000117-link">Show source...</a></p><div class="source" id="M000117-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 103</span>
103:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
104:       <span class="ruby-identifier">class_uri</span>.<span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
105:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000116"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000116'>


find_all

(*args)

</a>
</h3>
<p>
returns array of all instances of this class (e.g. Person.find_all) (always
returns collection)
</p>

<p class="source_link" id="M000116-show-link"><a onclick="toggle('M000116-source'); toggleText('M000116-link'); return false;" href="#" id="M000116-link">Show source...</a></p><div class="source" id="M000116-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 99</span>
 99:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">find_all</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
100:       <span class="ruby-identifier">find</span>(<span class="ruby-identifier">:all</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
101:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000115"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000115'>


method_missing

(method, *args)

</a>
</h3>
<p>
manages invocations such as Person.find_by_name, Person.find_by_foaf::name,
Person.find_by_foaf::name_and_foaf::knows, etc.
</p>

<p class="source_link" id="M000115-show-link"><a onclick="toggle('M000115-source'); toggleText('M000115-link'); return false;" href="#" id="M000115-link">Show source...</a></p><div class="source" id="M000115-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 82</span>
82:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
83:       <span class="ruby-keyword kw">if</span> <span class="ruby-regexp re">/find_by_(.+)/</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>)
84:         <span class="ruby-identifier">$activerdflog</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;constructing dynamic finder for #{method}&quot;</span>
85: 
86:         <span class="ruby-comment cmt"># construct proxy to handle delayed lookups </span>
87:         <span class="ruby-comment cmt"># (find_by_foaf::name_and_foaf::age)</span>
88:         <span class="ruby-identifier">proxy</span> = <span class="ruby-constant">DynamicFinderProxy</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$1</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
89: 
90:         <span class="ruby-comment cmt"># if proxy already found a value (find_by_name) we will not get a more </span>
91:         <span class="ruby-comment cmt"># complex query, so return the value. Otherwise, return the proxy so that </span>
92:         <span class="ruby-comment cmt"># subsequent lookups are handled</span>
93:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">proxy</span>.<span class="ruby-identifier">value</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">proxy</span>
94:       <span class="ruby-keyword kw">end</span>
95:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000108"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000108'>


new

(uri)

</a>
</h3>
<p>
creates <a href="Resource.html#M000108">new</a> resource representing an
RDF resource
</p>

<p class="source_link" id="M000108-show-link"><a onclick="toggle('M000108-source'); toggleText('M000108-link'); return false;" href="#" id="M000108-link">Show source...</a></p><div class="source" id="M000108-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 26</span>
26:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span> <span class="ruby-identifier">uri</span>
27:       <span class="ruby-ivar">@uri</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">uri</span>
28:             <span class="ruby-keyword kw">when</span> <span class="ruby-constant">RDFS</span><span class="ruby-operator">::</span><span class="ruby-constant">Resource</span>
29:              <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">uri</span>
30:             <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
31:               <span class="ruby-identifier">uri</span>
32:             <span class="ruby-keyword kw">else</span> 
33:               <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRdfError</span>, <span class="ruby-node">&quot;cannot create resource &lt;#{uri}&gt;&quot;</span>
34:             <span class="ruby-keyword kw">end</span>
35:                         <span class="ruby-ivar">@predicates</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
36:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000114"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000114'>


predicates

()

</a>
</h3>
<p>
returns the <a href="Resource.html#M000114">predicates</a> that have this
resource as their domain (applicable <a
href="Resource.html#M000114">predicates</a> for this resource)
</p>

<p class="source_link" id="M000114-show-link"><a onclick="toggle('M000114-source'); toggleText('M000114-link'); return false;" href="#" id="M000114-link">Show source...</a></p><div class="source" id="M000114-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 75</span>
75:     <span class="ruby-keyword kw">def</span> <span class="ruby-constant">Resource</span>.<span class="ruby-identifier">predicates</span>
76:       <span class="ruby-identifier">domain</span> = <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-identifier">:rdfs</span>, <span class="ruby-identifier">:domain</span>)
77:       <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:p</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:p</span>, <span class="ruby-identifier">domain</span>, <span class="ruby-identifier">class_uri</span>).<span class="ruby-identifier">execute</span> <span class="ruby-operator">||</span> []
78:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000109"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000109'>


uri

()

</a>
</h3>

<p class="source_link" id="M000109-show-link"><a onclick="toggle('M000109-source'); toggleText('M000109-link'); return false;" href="#" id="M000109-link">Show source...</a></p><div class="source" id="M000109-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 43</span>
43:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">uri</span>; <span class="ruby-identifier">class_uri</span>.<span class="ruby-identifier">uri</span>; <span class="ruby-keyword kw">end</span></pre></div>
</div></div>


<div class="section_spacer"></div><h1>Public Instance methods</h1>


<a class="small" name="M000113"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000113'>


&lt;=&gt;

(other)

</a>
</h3>
<p>
overriding sort based on <a href="Resource.html#M000109">uri</a>
</p>

<p class="source_link" id="M000113-show-link"><a onclick="toggle('M000113-source'); toggleText('M000113-link'); return false;" href="#" id="M000113-link">Show source...</a></p><div class="source" id="M000113-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 65</span>
65:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;=&gt;</span>(<span class="ruby-identifier">other</span>)
66:       <span class="ruby-identifier">uri</span> <span class="ruby-operator">&lt;=&gt;</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">uri</span>
67:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000111"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000111'>


==

(other)

</a>
</h3>
<p>
a resource is same as another if they both represent the same <a
href="Resource.html#M000109">uri</a>
</p>

<p class="source_link" id="M000111-show-link"><a onclick="toggle('M000111-source'); toggleText('M000111-link'); return false;" href="#" id="M000111-link">Show source...</a></p><div class="source" id="M000111-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 53</span>
53:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)
54:       <span class="ruby-identifier">other</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:uri</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">uri</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">false</span>
55:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000120"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000120'>


[]

(predicate)

</a>
</h3>
<p>
quick fix for &quot;direct&quot; getting of <a
href="Resource.html#M000114">predicates</a>
</p>

<p class="source_link" id="M000120-show-link"><a onclick="toggle('M000120-source'); toggleText('M000120-link'); return false;" href="#" id="M000120-link">Show source...</a></p><div class="source" id="M000120-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 161</span>
161:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">predicate</span>)
162:       <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:o</span>).<span class="ruby-identifier">where</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-constant">RDFS</span><span class="ruby-operator">::</span><span class="ruby-constant">Resource</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">predicate</span>), <span class="ruby-identifier">:o</span>).<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">:flatten</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>)
163:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000121"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000121'>


[]=

(predicate, value)

</a>
</h3>
<p>
quick fix for &quot;direct&quot; setting of <a
href="Resource.html#M000114">predicates</a>
</p>

<p class="source_link" id="M000121-show-link"><a onclick="toggle('M000121-source'); toggleText('M000121-link'); return false;" href="#" id="M000121-link">Show source...</a></p><div class="source" id="M000121-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 166</span>
166:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">predicate</span>, <span class="ruby-identifier">value</span>)
167:       <span class="ruby-constant">FederationManager</span>.<span class="ruby-identifier">add</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-constant">RDFS</span><span class="ruby-operator">::</span><span class="ruby-constant">Resource</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">predicate</span>), <span class="ruby-identifier">value</span>)
168:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000125"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000125'>


add_predicate

(localname, fulluri)

</a>
</h3>

<p class="source_link" id="M000125-show-link"><a onclick="toggle('M000125-source'); toggleText('M000125-link'); return false;" href="#" id="M000125-link">Show source...</a></p><div class="source" id="M000125-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 335</span>
335:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_predicate</span> <span class="ruby-identifier">localname</span>, <span class="ruby-identifier">fulluri</span>
336:                         <span class="ruby-identifier">localname</span> = <span class="ruby-identifier">localname</span>.<span class="ruby-identifier">to_s</span>
337:                         <span class="ruby-identifier">fulluri</span> = <span class="ruby-constant">RDFS</span><span class="ruby-operator">::</span><span class="ruby-constant">Resource</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">fulluri</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">fulluri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
338: 
339:                         <span class="ruby-comment cmt"># predicates is a hash from abbreviation string to full uri resource</span>
340:                         <span class="ruby-ivar">@predicates</span>[<span class="ruby-identifier">localname</span>] = <span class="ruby-identifier">fulluri</span>
341:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000127"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000127'>


class_level_predicates

()

</a>
</h3>
<p>
returns all <a href="Resource.html#M000114">predicates</a> that fall into
the domain of the rdf:<a href="Resource.html#M000124">type</a> of this
resource
</p>

<p class="source_link" id="M000127-show-link"><a onclick="toggle('M000127-source'); toggleText('M000127-link'); return false;" href="#" id="M000127-link">Show source...</a></p><div class="source" id="M000127-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 351</span>
351:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">class_level_predicates</span>
352:                         <span class="ruby-identifier">type</span> = <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-identifier">:rdf</span>, <span class="ruby-value str">'type'</span>)
353:                         <span class="ruby-identifier">domain</span> = <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-identifier">:rdfs</span>, <span class="ruby-value str">'domain'</span>)
354:                         <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:p</span>).<span class="ruby-identifier">where</span>(<span class="ruby-keyword kw">self</span>,<span class="ruby-identifier">type</span>,<span class="ruby-identifier">:t</span>).<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:p</span>, <span class="ruby-identifier">domain</span>, <span class="ruby-identifier">:t</span>).<span class="ruby-identifier">execute</span> <span class="ruby-operator">||</span> []
355:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000128"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000128'>


direct_predicates

(distinct = true)

</a>
</h3>
<p>
returns all <a href="Resource.html#M000114">predicates</a> that are
directly defined for this resource
</p>

<p class="source_link" id="M000128-show-link"><a onclick="toggle('M000128-source'); toggleText('M000128-link'); return false;" href="#" id="M000128-link">Show source...</a></p><div class="source" id="M000128-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 358</span>
358:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">direct_predicates</span>(<span class="ruby-identifier">distinct</span> = <span class="ruby-keyword kw">true</span>)
359:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">distinct</span>
360:                                 <span class="ruby-identifier">q</span> = <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:p</span>)
361:                         <span class="ruby-keyword kw">else</span>
362:                                 <span class="ruby-identifier">q</span> = <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">select</span>(<span class="ruby-identifier">:p</span>)
363:                         <span class="ruby-keyword kw">end</span>
364:                         <span class="ruby-identifier">q</span>.<span class="ruby-identifier">where</span>(<span class="ruby-keyword kw">self</span>,<span class="ruby-identifier">:p</span>, <span class="ruby-identifier">:o</span>).<span class="ruby-identifier">execute</span>
365:                         <span class="ruby-comment cmt">#return (direct + direct.collect {|d| ancestors(d)}).flatten.uniq</span>
366:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000118"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000118'>


find

(*args) {|resource| ...}

</a>
</h3>
<pre>
                        #####
</pre>
<p>
instance level methods #####
</p>
<pre>
                        #####
</pre>

<p class="source_link" id="M000118-show-link"><a onclick="toggle('M000118-source'); toggleText('M000118-link'); return false;" href="#" id="M000118-link">Show source...</a></p><div class="source" id="M000118-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 110</span>
110:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">find</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
111:       <span class="ruby-comment cmt"># extract sort options from args</span>
112:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-operator">:</span> {}
113: 
114:       <span class="ruby-identifier">query</span> = <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:s</span>)
115:       <span class="ruby-identifier">query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:s</span>, <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-identifier">:rdf</span>,<span class="ruby-identifier">:type</span>), <span class="ruby-keyword kw">self</span>)
116: 
117:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">:order</span>
118:         <span class="ruby-identifier">sort_predicate</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:order</span>]
119:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">sort</span>(<span class="ruby-identifier">:sort_value</span>)
120:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:s</span>, <span class="ruby-identifier">sort_predicate</span>, <span class="ruby-identifier">:sort_value</span>)
121:       <span class="ruby-keyword kw">end</span>
122: 
123:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">:reverse_order</span>
124:         <span class="ruby-identifier">sort_predicate</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:reverse_order</span>]
125:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">reverse_sort</span>(<span class="ruby-identifier">:sort_value</span>)
126:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:s</span>, <span class="ruby-identifier">sort_predicate</span>, <span class="ruby-identifier">:sort_value</span>)
127:       <span class="ruby-keyword kw">end</span>
128: 
129:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">:where</span>
130:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRdfError</span>, <span class="ruby-value str">&quot;where clause should be hash of predicate =&gt; object&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:where</span>].<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
131:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:where</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span>,<span class="ruby-identifier">o</span><span class="ruby-operator">|</span>
132:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">:context</span>
133:             <span class="ruby-identifier">query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:s</span>, <span class="ruby-identifier">p</span>, <span class="ruby-identifier">o</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:context</span>])
134:           <span class="ruby-keyword kw">else</span>
135:             <span class="ruby-identifier">query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:s</span>, <span class="ruby-identifier">p</span>, <span class="ruby-identifier">o</span>)
136:           <span class="ruby-keyword kw">end</span>
137:         <span class="ruby-keyword kw">end</span>
138:       <span class="ruby-keyword kw">else</span>
139:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:context</span>]
140:           <span class="ruby-identifier">query</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">:s</span>, <span class="ruby-identifier">:p</span>, <span class="ruby-identifier">:o</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:context</span>])
141:         <span class="ruby-keyword kw">end</span>
142:       <span class="ruby-keyword kw">end</span>
143: 
144:       <span class="ruby-identifier">query</span>.<span class="ruby-identifier">limit</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:limit</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:limit</span>]
145:       <span class="ruby-identifier">query</span>.<span class="ruby-identifier">offset</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:offset</span>]) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:offset</span>]
146: 
147:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
148:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">execute</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">resource</span><span class="ruby-operator">|</span>
149:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">resource</span>
150:         <span class="ruby-keyword kw">end</span>
151:       <span class="ruby-keyword kw">else</span>
152:         <span class="ruby-identifier">query</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">:flatten</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">false</span>)
153:       <span class="ruby-keyword kw">end</span>
154:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000112"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000112'>


hash

()

</a>
</h3>
<p>
overriding <a href="Resource.html#M000112">hash</a> to use uri.hash needed
for array.uniq
</p>

<p class="source_link" id="M000112-show-link"><a onclick="toggle('M000112-source'); toggleText('M000112-link'); return false;" href="#" id="M000112-link">Show source...</a></p><div class="source" id="M000112-source"><pre>    <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 60</span>
60:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">hash</span>
61:       <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">hash</span>
62:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000130"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000130'>


include?

(other)

</a>
</h3>
<p>
Alias for #==
</p>

</div></div>

<a class="small" name="M000126"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000126'>


instance_of?

(klass)

</a>
</h3>
<p>
overrides built-in <a href="Resource.html#M000126">instance_of?</a> to use
rdf:<a href="Resource.html#M000124">type</a> definitions
</p>

<p class="source_link" id="M000126-show-link"><a onclick="toggle('M000126-source'); toggleText('M000126-link'); return false;" href="#" id="M000126-link">Show source...</a></p><div class="source" id="M000126-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 345</span>
345:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">instance_of?</span>(<span class="ruby-identifier">klass</span>)
346:                         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">type</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">klass</span>)
347:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000119"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000119'>


localname

()

</a>
</h3>

<p class="source_link" id="M000119-show-link"><a onclick="toggle('M000119-source'); toggleText('M000119-link'); return false;" href="#" id="M000119-link">Show source...</a></p><div class="source" id="M000119-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 156</span>
156:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">localname</span>
157:       <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">localname</span>(<span class="ruby-keyword kw">self</span>)
158:     <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000122"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000122'>


method_missing

(method, *args)

</a>
</h3>
<p>
manages invocations such as eyal.age
</p>

<p class="source_link" id="M000122-show-link"><a onclick="toggle('M000122-source'); toggleText('M000122-link'); return false;" href="#" id="M000122-link">Show source...</a></p><div class="source" id="M000122-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 171</span>
171:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">method</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
172:       <span class="ruby-comment cmt"># possibilities:</span>
173:       <span class="ruby-comment cmt"># 1. eyal.age is a property of eyal (triple exists &lt;eyal&gt; &lt;age&gt; &quot;30&quot;)</span>
174:       <span class="ruby-comment cmt"># evidence: eyal age ?a, ?a is not nil (only if value exists)</span>
175:       <span class="ruby-comment cmt"># action: return ?a</span>
176:       <span class="ruby-comment cmt">#</span>
177:       <span class="ruby-comment cmt"># 2. eyal's class is in domain of age, but does not have value for eyal</span>
178:       <span class="ruby-comment cmt"># explain: eyal is a person and some other person (not eyal) has an age</span>
179:       <span class="ruby-comment cmt"># evidence: eyal type ?c, age domain ?c</span>
180:       <span class="ruby-comment cmt"># action: return nil</span>
181:       <span class="ruby-comment cmt">#</span>
182:       <span class="ruby-comment cmt"># 3. eyal.age = 30 (setting a value for a property)</span>
183:       <span class="ruby-comment cmt"># explain: eyal has (or could have) a value for age, and we update that value</span>
184:       <span class="ruby-comment cmt"># complication: we need to find the full URI for age (by looking at</span>
185:       <span class="ruby-comment cmt"># possible predicates to use</span>
186:       <span class="ruby-comment cmt"># evidence: eyal age ?o  (eyal has a value for age now, we're updating it)</span>
187:       <span class="ruby-comment cmt"># evidence: eyal type ?c, age domain ?c (eyal could have a value for age, we're setting it)</span>
188:       <span class="ruby-comment cmt"># action: add triple (eyal, age, 30), return 30</span>
189:       <span class="ruby-comment cmt">#</span>
190:       <span class="ruby-comment cmt"># 4. eyal.age is a custom-written method in class Person</span>
191:       <span class="ruby-comment cmt"># evidence: eyal type ?c, ?c.methods includes age</span>
192:       <span class="ruby-comment cmt"># action: inject age into eyal and invoke</span>
193:                         <span class="ruby-comment cmt">#</span>
194:                         <span class="ruby-comment cmt"># 5. eyal.age is registered abbreviation </span>
195:                         <span class="ruby-comment cmt"># evidence: age in @predicates</span>
196:                         <span class="ruby-comment cmt"># action: return object from triple (eyal, @predicates[age], ?o)</span>
197:                         <span class="ruby-comment cmt">#</span>
198:                         <span class="ruby-comment cmt"># 6. eyal.foaf::name, where foaf is a registered abbreviation</span>
199:                         <span class="ruby-comment cmt"># evidence: foaf in Namespace.</span>
200:                         <span class="ruby-comment cmt"># action: return namespace proxy that handles 'name' invocation, by </span>
201:                         <span class="ruby-comment cmt"># rewriting into predicate lookup (similar to case (5)</span>
202: 
203:       <span class="ruby-identifier">$activerdflog</span>.<span class="ruby-identifier">debug</span> <span class="ruby-node">&quot;method_missing: #{method}&quot;</span>
204: 
205:       <span class="ruby-comment cmt"># are we doing an update or not? </span>
206:                         <span class="ruby-comment cmt"># checking if method ends with '='</span>
207: 
208:       <span class="ruby-identifier">update</span> = <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">-1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
209:       <span class="ruby-identifier">methodname</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">update</span> 
210:                      <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]
211:                    <span class="ruby-keyword kw">else</span>
212:                      <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>
213:                    <span class="ruby-keyword kw">end</span>
214: 
215:       <span class="ruby-comment cmt"># extract single values from array unless user asked for eyal.all_age</span>
216:       <span class="ruby-identifier">flatten</span> = <span class="ruby-keyword kw">true</span>
217:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">3</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'all_'</span>
218:         <span class="ruby-identifier">flatten</span> = <span class="ruby-keyword kw">false</span>
219:         <span class="ruby-identifier">methodname</span> = <span class="ruby-identifier">methodname</span>[<span class="ruby-value">4</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
220:       <span class="ruby-keyword kw">end</span>
221: 
222:                         <span class="ruby-comment cmt"># check possibility (5)</span>
223:                         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@predicates</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">methodname</span>)
224:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">predicate_invocation</span>(<span class="ruby-ivar">@predicates</span>[<span class="ruby-identifier">methodname</span>], <span class="ruby-identifier">args</span>, <span class="ruby-identifier">update</span>, <span class="ruby-identifier">flatten</span>)
225:                         <span class="ruby-keyword kw">end</span>
226: 
227:                         <span class="ruby-comment cmt"># check possibility (6)</span>
228:                         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">abbreviations</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">methodname</span>.<span class="ruby-identifier">to_sym</span>)
229:                                 <span class="ruby-identifier">namespace</span> = <span class="ruby-constant">Object</span>.<span class="ruby-identifier">new</span>      
230:                                 <span class="ruby-ivar">@@uri</span> = <span class="ruby-identifier">methodname</span>
231:                                 <span class="ruby-ivar">@@subject</span> = <span class="ruby-keyword kw">self</span>
232:         <span class="ruby-ivar">@@flatten</span> = <span class="ruby-identifier">flatten</span>
233: 
234:         <span class="ruby-comment cmt"># catch the invocation on the namespace</span>
235:         <span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">namespace</span>
236:           <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">localname</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
237:             <span class="ruby-comment cmt"># check if updating or reading predicate value</span>
238:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">localname</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">-1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'='</span>
239:               <span class="ruby-comment cmt"># set value</span>
240:               <span class="ruby-identifier">predicate</span> = <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-ivar">@@uri</span>, <span class="ruby-identifier">localname</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>])
241:               <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span> <span class="ruby-constant">FederationManager</span>.<span class="ruby-identifier">add</span>(<span class="ruby-ivar">@@subject</span>, <span class="ruby-identifier">predicate</span>, <span class="ruby-identifier">value</span>) }
242:             <span class="ruby-keyword kw">else</span>
243:               <span class="ruby-comment cmt"># read value</span>
244:               <span class="ruby-identifier">predicate</span> = <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-ivar">@@uri</span>, <span class="ruby-identifier">localname</span>)
245:               <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:o</span>).<span class="ruby-identifier">where</span>(<span class="ruby-ivar">@@subject</span>, <span class="ruby-identifier">predicate</span>, <span class="ruby-identifier">:o</span>).<span class="ruby-identifier">execute</span>(<span class="ruby-identifier">:flatten</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@@flatten</span>)
246:             <span class="ruby-keyword kw">end</span>
247:           <span class="ruby-keyword kw">end</span>
248:           <span class="ruby-identifier">private</span>(<span class="ruby-identifier">:type</span>)
249:         <span class="ruby-keyword kw">end</span>
250:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">namespace</span>
251:       <span class="ruby-keyword kw">end</span>
252: 
253:       <span class="ruby-identifier">candidates</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">update</span>
254:                       (<span class="ruby-identifier">class_level_predicates</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">direct_predicates</span>).<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">uniq</span>
255:                     <span class="ruby-keyword kw">else</span>
256:                       <span class="ruby-identifier">direct_predicates</span>
257:                     <span class="ruby-keyword kw">end</span>
258: 
259:                         <span class="ruby-comment cmt"># checking possibility (1) and (3)</span>
260:                         <span class="ruby-identifier">candidates</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pred</span><span class="ruby-operator">|</span>
261:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">localname</span>(<span class="ruby-identifier">pred</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">methodname</span>
262:                                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">predicate_invocation</span>(<span class="ruby-identifier">pred</span>, <span class="ruby-identifier">args</span>, <span class="ruby-identifier">update</span>, <span class="ruby-identifier">flatten</span>)
263:                                 <span class="ruby-keyword kw">end</span>
264:                         <span class="ruby-keyword kw">end</span>
265:                         
266:                         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ActiveRdfError</span>, <span class="ruby-node">&quot;could not set #{methodname} to #{args}: no suitable 
267:                         predicate found. Maybe you are missing some schema information?&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">update</span>
268: 
269:                         <span class="ruby-comment cmt"># get/set attribute value did not succeed, so checking option (2) and (4)</span>
270:                         
271:                         <span class="ruby-comment cmt"># checking possibility (2), it is not handled correctly above since we use</span>
272:                         <span class="ruby-comment cmt"># direct_predicates instead of class_level_predicates. If we didn't find</span>
273:                         <span class="ruby-comment cmt"># anything with direct_predicates, we need to try the</span>
274:                         <span class="ruby-comment cmt"># class_level_predicates. Only if we don't find either, we</span>
275:                         <span class="ruby-comment cmt"># throw &quot;method_missing&quot;</span>
276:                         <span class="ruby-identifier">candidates</span> = <span class="ruby-identifier">class_level_predicates</span>
277: 
278:                         <span class="ruby-comment cmt"># if any of the class_level candidates fits the sought method, then we</span>
279:                         <span class="ruby-comment cmt"># found situation (2), so we return nil or [] depending on the {:array =&gt;</span>
280:                         <span class="ruby-comment cmt"># true} value</span>
281:                         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">candidates</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">localname</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">methodname</span>}
282:                                 <span class="ruby-identifier">return_ary</span> = <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">:array</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
283:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">return_ary</span>
284:                                         <span class="ruby-keyword kw">return</span> []
285:                                 <span class="ruby-keyword kw">else</span>
286:                                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
287:                                 <span class="ruby-keyword kw">end</span>
288:                         <span class="ruby-keyword kw">end</span>
289: 
290:                         <span class="ruby-comment cmt"># checking possibility (4)</span>
291:                         <span class="ruby-comment cmt"># TODO: implement search strategy to select in which class to invoke</span>
292:                         <span class="ruby-comment cmt"># e.g. if to_s defined in Resource and in Person we should use Person</span>
293:                         <span class="ruby-identifier">$activerdflog</span>.<span class="ruby-identifier">debug</span> <span class="ruby-value str">&quot;RDFS::Resource: method_missing option 4: custom class method&quot;</span>
294:                         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">type</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">klass</span><span class="ruby-operator">|</span>
295:                                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">instance_methods</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>)
296:                                         <span class="ruby-identifier">_dup</span> = <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>)
297:                                         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">_dup</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">method</span>,<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
298:                                 <span class="ruby-keyword kw">end</span>
299:                         <span class="ruby-keyword kw">end</span>
300: 
301:                         <span class="ruby-comment cmt"># if none of the three possibilities work out, we don't know this method</span>
302:                         <span class="ruby-comment cmt"># invocation, but we don't want to throw NoMethodError, instead we return</span>
303:                         <span class="ruby-comment cmt"># nil, so that eyal.age does not raise error, but returns nil. (in RDFS,</span>
304:                         <span class="ruby-comment cmt"># we are never sure that eyal cannot have an age, we just dont know the</span>
305:                         <span class="ruby-comment cmt"># age right now)</span>
306:                         <span class="ruby-keyword kw">nil</span>
307:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000129"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000129'>


property_accessors

()

</a>
</h3>

<p class="source_link" id="M000129-show-link"><a onclick="toggle('M000129-source'); toggleText('M000129-link'); return false;" href="#" id="M000129-link">Show source...</a></p><div class="source" id="M000129-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 368</span>
368:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">property_accessors</span>
369:                         <span class="ruby-identifier">direct_predicates</span>.<span class="ruby-identifier">collect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">pred</span><span class="ruby-operator">|</span> <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">localname</span>(<span class="ruby-identifier">pred</span>) }
370:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000123"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000123'>


save

()

</a>
</h3>
<p>
saves instance into datastore
</p>

<p class="source_link" id="M000123-show-link"><a onclick="toggle('M000123-source'); toggleText('M000123-link'); return false;" href="#" id="M000123-link">Show source...</a></p><div class="source" id="M000123-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 310</span>
310:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">save</span>
311:                         <span class="ruby-identifier">db</span> = <span class="ruby-constant">ConnectionPool</span>.<span class="ruby-identifier">write_adapter</span>
312:                         <span class="ruby-identifier">rdftype</span> = <span class="ruby-constant">Namespace</span>.<span class="ruby-identifier">lookup</span>(<span class="ruby-identifier">:rdf</span>, <span class="ruby-identifier">:type</span>)
313:                         <span class="ruby-identifier">types</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
314:                                 <span class="ruby-identifier">db</span>.<span class="ruby-identifier">add</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">rdftype</span>, <span class="ruby-identifier">t</span>)
315:                         <span class="ruby-keyword kw">end</span>
316: 
317:                         <span class="ruby-constant">Query</span>.<span class="ruby-identifier">new</span>.<span class="ruby-identifier">distinct</span>(<span class="ruby-identifier">:p</span>,<span class="ruby-identifier">:o</span>).<span class="ruby-identifier">where</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">:p</span>, <span class="ruby-identifier">:o</span>).<span class="ruby-identifier">execute</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span>, <span class="ruby-identifier">o</span><span class="ruby-operator">|</span>
318:                                 <span class="ruby-identifier">db</span>.<span class="ruby-identifier">add</span>(<span class="ruby-keyword kw">self</span>, <span class="ruby-identifier">p</span>, <span class="ruby-identifier">o</span>)
319:                         <span class="ruby-keyword kw">end</span>
320:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000131"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000131'>


to_s

()

</a>
</h3>
<p>
returns <a href="Resource.html#M000109">uri</a> of resource, can be
overridden in subclasses
</p>

<p class="source_link" id="M000131-show-link"><a onclick="toggle('M000131-source'); toggleText('M000131-link'); return false;" href="#" id="M000131-link">Show source...</a></p><div class="source" id="M000131-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 377</span>
377:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
378:                         <span class="ruby-node">&quot;&lt;#{uri}&gt;&quot;</span>
379:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>

<a class="small" name="M000124"><br/></a>
<div class="a_method"><div><h3>
<a href='#M000124'>


type

()

</a>
</h3>
<p>
returns all rdf:<a href="Resource.html#M000124">type</a> of this instance,
e.g. [<a href="Resource.html">RDFS::Resource</a>, FOAF::Person]
</p>
<p>
Note: this method performs a database lookup for { self rdf:<a
href="Resource.html#M000124">type</a> ?o }. For simple <a
href="Resource.html#M000124">type</a>-checking (to know if you are handling
an ActiveRDF object, use self.class, which does not do a database query,
but simply returns <a href="Resource.html">RDFS::Resource</a>.
</p>

<p class="source_link" id="M000124-show-link"><a onclick="toggle('M000124-source'); toggleText('M000124-link'); return false;" href="#" id="M000124-link">Show source...</a></p><div class="source" id="M000124-source"><pre>     <span class="ruby-comment cmt"># File lib/active_rdf/objectmanager/resource.rb, line 329</span>
329:                 <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">type</span>
330:                         <span class="ruby-identifier">types</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">type</span><span class="ruby-operator">|</span>
331:                                 <span class="ruby-constant">ObjectManager</span>.<span class="ruby-identifier">construct_class</span>(<span class="ruby-identifier">type</span>)
332:                         <span class="ruby-keyword kw">end</span>
333:                 <span class="ruby-keyword kw">end</span></pre></div>
</div></div>





</div></div><div class="clear" id="footer"><a href="http://blog.evanweaver.com/articles/2006/06/02/allison">Allison</a></div></body></html>